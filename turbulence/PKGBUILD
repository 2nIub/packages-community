# Maintainer: dcell <sesshomaru@hushmail.com>

pkgname=turbulence
pkgver=0.2
pkgrel=1
pkgdesc="System configurer at boot for KDE, similar to Chakra's Kapudan."
url="http://manjaro.org"
depends=('python2' 'python2-pyqt4' 'pyqt4-common' 'qt4')
license=('GPL')
arch=('any')

_git=no
_snapshot=fdfdf62f6861d0d8a9cb282cc6322a99b60163c0

if [ "$_git" == "Yes" ]; then
   source=(git+http://git.manjaro.org/community/turbulence.git)
   sha256sums=('SKIP')
else
   #source=("turbulence-$pkgver.tar.gz::http://git.manjaro.org/community/turbulence/repository/archive?ref=v$pkgver")
   #sha256sums=('646bad5c4bb8b1b2fa049ae75a7e0adadeef791b222477ffd95a7e7da4b248ad')
   source=("turbulence-$pkgver-$pkgrel.tar.gz::http://git.manjaro.org/community/turbulence/repository/archive?ref=$_snapshot")
   sha256sums=('646bad5c4bb8b1b2fa049ae75a7e0adadeef791b222477ffd95a7e7da4b248ad')
fi

package() {
    if [ -e "$srcdir/core-$pkgname" ]; then
       cd "$srcdir/core-$pkgname"
    fi
    if [ -e "$srcdir/$pkgname" ]; then
       cd "$srcdir/$pkgname"
    fi
    if [ -e "$srcdir/$pkgname.git" ]; then
       cd "$srcdir/$pkgname.git"
    fi
    mkdir -p $pkgdir/usr/bin
    mkdir -p $pkgdir/usr/share/turbulence
    mkdir -p $pkgdir/usr/share/apps/aurorae/themes
    mkdir -p $pkgdir/usr/share/wallpapers
    mv $srcdir/turbulence/turbulence $pkgdir/usr/bin/turbulence
    mv $srcdir/turbulence/themes/* $pkgdir/usr/share/apps/aurorae/themes
    mv $srcdir/turbulence/wallpapers/* $pkgdir/usr/share/wallpapers
    rm -r $srcdir/turbulence/themes
    rm -r $srcdir/turbulence/wallpapers
    chmod +x $pkgdir/usr/bin/turbulence
    cp -r $srcdir/turbulence/* $pkgdir/usr/share/turbulence
    chmod +x $pkgdir/usr/share/turbulence/turbulencerunner
    chmod +x $pkgdir/usr/share/turbulence/install.sh
}
