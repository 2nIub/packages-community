# Contributor: Rob McCathie <rob@manjaro.org>
# Contributor: Bernhard Landauer <oberon@manjaro.org>
# Contributor: CanalGuada <dguadal at free dot fr>
# Author: horst3180 @ deviantart

pkgname=vertex-manjaro-themes
pkgver=20160414
pkgrel=1
pkgdesc='Vertex-Manjaro Gtk2, Gtk3, Metacity, Xfwm, Cinnamon and GNOME Shell themes (GNOME 3.20 version)'
_gnomever=3.20
_releasever=20160329
arch=('any')
url='http://horst3180.deviantart.com/art/Vertex-Theme-470663601'
license=('GPL3')
depends=('gtk-engine-murrine')
makedepends=('imagemagick')
source=("vertex-${_releasever}.tar.gz::https://github.com/horst3180/Vertex-theme/archive/${_releasever}.tar.gz"
	'menuitem.png'
	'progressbar.png'
	'progressbar_v.png')
sha256sums=('c075c9fc059a5b2e30e65242a000083b5f8621a5cdfebb7ac61c31e33c6cbe85'
            '148be77e522f75493808faa4ec7436ea3d39bc79f1e3449a8faf9946621c73a3'
            '421ad50c2d621ca8d4f0362990012afb952b30778267eb7be13dc502b30cdd42'
            '1402962fd31b172525f945fcf4d8235595ce66d9b170d9384a384bb997800d11')
options=('!strip')

build() {
  cd vertex-theme-${_releasever}
  ./autogen.sh --prefix=/usr --with-gnome=${_gnomever}
}
package() {
  cd vertex-theme-${_releasever}

  make DESTDIR="$pkgdir" install
  cd extra
  for name in "Chrome" "Firefox" "Vertex-Plank" "Vertex_alt_metacity"; do
    find "$name" -type f -not -name *~ -exec install -Dm644 '{}' "$pkgdir/usr/share/themes/{}" \;
  done

  cd ..
  install -Dm644 COPYING "$pkgdir/usr/share/licenses/$pkgname/COPYING"
  ## We need to provide our own README
  #install -Dm644 README.md "$pkgdir/usr/share/themes/Vertex/README"

  ### Manjarification ###
  msg "This next bit might take a little while..."
  
  cd "$pkgdir/usr/share/themes"
  rm -r Vertex{-Light,-Plank,_alt_metacity}
  rm -r Chrome Firefox # i'd think these two need modifying, not deleting, this is only happening during development
  mv Vertex Vertex-Manjaro
  mv Vertex-Dark Vertex-Manjaro-Dark
  
  ## Any plain text we can find within any file in the theme that reads "Vertex" is replaced with "Vertex-Manjaro"
  find . -type f -exec sed -i "s/Vertex/Vertex-Manjaro/g" {} \;
  
  ## Shift the hightlight-hue of all image files from blue to maia-greenish
  find . -name "*.png" -exec mogrify -modulate 100,100,71 {} \;
  find . -name "*.svg" -exec mogrify -background none -modulate 100,100,71 {} \;
  
  ## Adjust color values
  find . -name "*.css" -exec sed -i \
	"s/0553ea/1ceab6/g;\
	s/0e5ffa/28fab8/g;\
	s/122237/123722/g;\
	s/171819/171918/g;\
	s/1c1d1e/1c1e1d/g;\
	s/244672/247246/g;\
	s/276ffa/41fabc/g;\
	s/284d7d/287d4d/g;\
	s/29292b/292b29/g;\
	s/2a5285/2a8552/g;\
	s/2b2b2d/2b2d2b/g;\
	s/2b2c2e/2b2e2c/g;\
	s/2b5489/2b8954/g;\
	s/2c578d/2c8d57/g;\
	s/2c73fb/2cfbb9/g;\
	s/313132/313231/g;\
	s/3176fb/4bfbc0/g;\
	s/343436/343634/g;\
	s/353638/353836/g;\
	s/37383A/373A38/g;\
	s/38393b/383b39/g;\
	s/393A3B/393B3A/g;\
	s/39689f/399f68/g;\
	s/3a3b3d/3a3d3b/g;\
	s/3a6fa9/3aa96f/g;\
	s/3a73e2/51e2b2/g;\
	s/3b3c3f/3b3f3c/g;\
	s/3c3c3e/3c3e3c/g;\
	s/3c3e40/3c403e/g;\
	s/3d3e40/3d403e/g;\
	s/3e5e9d/3e9d5e/g;\
	s/407cbc/40bc7c/g;\
	s/404042/404240/g;\
	s/4080fb/58fbc7/g;\
	s/434446/434644/g;\
	s/454649/454946/g;\
	s/46484a/464a48/g;\
	s/4a84c1/4ac184/g;\
	s/4a86fb/62fbc8/g;\
	s/4B4C4E/4B4E4C/g;\
	s/4b4d50/4b504d/g;\
	s/4e86c3/4ec386/g;\
	s/4f5053/4f5350/g;\
	s/4f5154/4f5451/g;\
	s/525254/4f5451/g;\
	s/538dfb/6cfbce/g;\
	s/548dfb/6cfbcb/g;\
	s/58585a/585a58/g;\
	s/5d5d5f/5d5f5d/g;\
	s/5d5e62/5d625e/g;\
	s/5d93fc/76fccf/g;\
	s/5e6064/5e6460/g;\
	s/616163/616361/g;\
	s/616263/616362/g;\
	s/6193c9/61c993/g;\
	s/628cdd/77ddbb/g;\
	s/656668/656866/g;\
	s/6596ca/65ca96/g;\
	s/6a6a6c/6a6c6a/g;\
	s/72a1fc/72fcc7/g;\
	s/747476/747674/g;\
	s/77a3f6/77f6c3/g;\
	s/78797a/787a79/g;\
	s/79a6fc/79fcc8/g;\
	s/7a7a7b/7a7b7a/g;\
	s/7c7d7f/7c7f7d/g;\
	s/7d7e7f/7d7f7e/g;\
	s/868688/868886/g;\
	s/88888b/888b88/g;\
	s/8a8a8b/8a8b8a/g;\
	s/8a8b8c/8a8c8b/g;\
	s/949596/949695/g;\
	s/949597/949795/g;\
	s/99999b/999b99/g;\
	s/9c9d9e/9c9e9d/g;\
	s/9cbdfd/9cfdd5/g;\
	s/9e9e9f/9e9f9e/g;\
	s/a0c0fd/a0fdc0/g;\
	s/a4c2fd/a4fdc2/g;\
	s/a5a5a7/a5a7a5/g;\
	s/a9a9aa/a9aaa9/g;\
	s/ababad/abadab/g;\
	s/b3ccfd/b3fdde/g;\
	s/b4b4b6/b4b6b4/g;\
	s/d0d0da/d0dad0/g;\
	s/d4e1fb/d4fbe1/g;\
	s/d9d9e0/d9e0d9/g;\
	s/d9e6fe/d9fee6/g;\
	s/dcdce3/dce3dc/g;\
	s/e2e2e4/e2e4e2/g;\
	s/e4e4e8/e4e8e4/g;\
	s/e7e7ec/e7ece7/g;\
	s/eaeaed/eaedea/g;\
	s/eaeaee/eaeeea/g;\
	s/ebebec/ebeceb/g;\
	s/ebebef/ebefeb/g;\
	s/ecf2ff/ecfff2/g;\
	s/ededf0/edf0ed/g;\
	s/F3F3F5/F3F5F3/g;\
	s/f5f5f7/f5f7f5/g;\
	s/f8f8f9/f8f9f8/g;\
	s/fafafb/fafbfa/g;\
	s/fbfbfc/fbfcfb/g;\
	s/ffffff/f9faf9/g;\
	s/4577d6, #4c86f3/16a085, #16a085/g;\
	s/6496F5, #5A86DB/16a085, #16a085/g;\
	s/14, 95, 250/14, 250, 95/g;\
	s/22, 22, 23/22, 23, 22/g;\
	s/25, 26, 29/25, 29, 26/g;\
	s/29, 29, 31/29, 31, 29/g;\
	s/34, 34, 36/34, 36, 34/g;\
	s/35, 35, 36/35, 36, 35/g;\
	s/36, 36, 38/36, 38, 36/g;\
	s/39, 39, 41/39, 41, 39/g;\
	s/41, 42, 43/41, 43, 42/g;\
	s/49, 49, 51/49, 51, 49/g;\
	s/51, 52, 54/51, 54, 52/g;\
	s/52, 52, 54/52, 54, 52/g;\
	s/60, 60, 62/60, 62, 60/g;\
	s/60, 62, 64/60, 64, 62/g;\
	s/64, 124, 188/64, 188, 124/g;\
	s/64, 128, 251/64, 251, 128/g;\
	s/65, 65, 67/65, 67, 65/g;\
	s/70, 70, 72/70, 72, 70/g;\
	s/82, 82, 85/82, 85, 82/g;\
	s/93, 93, 95/93, 95, 93/g;\
	s/100, 150, 245/100, 245, 150/g;\
	s/106, 106, 108/106, 108, 106/g;\
	s/120, 121, 122/120, 122, 121/g;\
	s/148, 149, 150/148, 150, 149/g;\
	s/171, 171, 173/171, 173, 171/g;\
	s/226, 226, 228/226, 228, 226/g;\
	s/243, 243, 245/243, 245, 243/g;\
	s/245, 245, 247/245, 247, 245/g;\
	s/114, 161, 252/114, 252, 161/g;\
	s/151516/151615/g;\
	s/1f1f20/1f201f/g;\
	s/242426/242624/g;\
	s/262627/262726/g;\
	s/2a2a2b/2a2b2a/g;\
	s/2B2B2C/2B2C2B/g;\
	s/2e2e30/2e302e/g;\
	s/2f3032/2f3230/g;\
	s/303031/303130/g;\
	s/303133/303331/g;\
	s/333436/333634/g;\
	s/344463/346353/g;\
	s/37393b/373b39/g;\
	s/37455f/375f52/g;\
	s/3a67bd/28bd8e/g;\
	s/3C3E40/3C403E/g;\
	s/3D5074/3D7463/g;\
	s/3d73dc/28dca0/g;\
	s/3e78e6/3ee6b1/g;\
	s/3f3f40/3f403f/g;\
	s/3f4042/3f4240/g;\
	s/3f7cf1/3ff1b9/g;\
	s/414245/414542/g;\
	s/414345/414543/g;\
	s/4e4f52/4e524f/g;\
	s/505255/505552/g;\
	s/5991fc/59fcc8/g;\
	s/78787a/787a78/g;\
	s/8bb2fd/8bfdd9/g;\
	s/8f8f91/8f918f/g;\
	s/9abaf8/81f8d0/g;\
	s/a3a3a5/a3a5a3/g;\
	s/a7a7a9/a7a9a7/g;\
	s/bababc/babcba/g;\
	s/cdcdcf/cdcfcd/g;\
	s/d7d7d9/d7d9d7/g" {} \;

  cd Vertex-Manjaro/gtk-2.0
  sed -i "s/3c3c3e/3c3e3c/g;\
	s/4080fb/16a085/g;\
	s/454749/454947/g;\
	s/F3F3F5/F3F5F3/g;\
	s/FFF"/F9FAF9/g;\
	s/FFFFFF/F9FAF9/g" gtkrc

  sed -i "s/232324/232423/g;\
	s/3C3E40/3C403E/g;\
	s/45474A/454A47/g;\
	s/F3F3F5/F3F5F3/g" panel.rc

  cd ../../Vertex-Manjaro-Dark/gtk-2.0
  sed -i "s/2B2B2C/2B2C2B/g;\
	s/2c2e2f/2c2f2e/g;\
	s/353638/353836/g;\
	s/3c3c3e/3c3e3c/g;\
	s/4080fb/16a085/g;\
	s/434446/434644/g;\
	s/454749/454947/g;\
	s/F3F3F5/F3F5F3/g;\
	s/FFF"/F9FAF9/g;\
	s/ffffff/f9faf9/g;\
	s/FFFFFF/F9FAF9/g" gtkrc

  sed -i "s/232324/232423/g;\
	s/3C3E40/3C403E/g;\
	s/45474A/454A47/g;\
	s/F3F3F5/F3F5F3/g" panel.rc

  ## use custom menuitem and progressbars
  cd "$pkgdir/usr/share/themes"
  tee Vertex-Manjaro{,-Dark}/gtk-2.0/Menu/menuitem.png < $srcdir/menuitem.png >/dev/null
  tee Vertex-Manjaro{,-Dark}/gtk-2.0/ProgressBar/progressbar.png < $srcdir/progressbar.png >/dev/null
  tee Vertex-Manjaro{,-Dark}/gtk-2.0/ProgressBar/progressbar_v.png < $srcdir/progressbar_v.png >/dev/null
}
