# Maintainer: Ramon Buld√≥ <rbuldo@gmail.com>
# Maintainer: Bernhard Landauer <oberon@manjaro.org
# Maintainer: Stefano Capitani <stefano@manjaro.org>

pkgname=manjaro-browser-settings
pkgver=20180215
pkgrel=1
pkgdesc="Manjaro Linux settings browser defaults"
arch=('i686' 'x86_64')
url="https://github.com/manjaro/$pkgname"
license=('GPL')
_gitcommit=446c12cf698207b82819098eab02711ae7a4ce27
_hook=manjaro-browser-settings
conflicts=('manjaro-firefox-settings')
replaces=('manjaro-firefox-settings')
source=("$pkgname-$_gitcommit.tar.gz::$url/archive/$_gitcommit.tar.gz"
		"$_hook-post.script"
		"$_hook-pre.script"
		"$_hook-pre.hook"
		"$_hook-post.hook")
md5sums=('e3408fe1652fd83fc1b98f47241e715f'
         '21e467d25db5e220aeeddff97e8a8261'
         'ca41fd4df50ce50fb3c3d6c1d3680015'
         'b902316c2fc1097484ffaa300504e962'
         'c4d3861c6a84e7c6b65b20fe38b8c087')

pkgver() {
  date +%Y%m%d
}

package() {
  cd $pkgname-$_gitcommit
  mkdir -p $pkgdir/usr/lib/{chrome,chromium,{firefox,firefox-developer-edition,palemoon}/distribution}
  cp chrome/* $pkgdir/usr/lib/chrome
  cp chrome/* $pkgdir/usr/lib/chromium
  cp firefox/distribution.ini $pkgdir/usr/lib/firefox/distribution/.distribution.mjo
  cp firefox-developer-edition/distribution.ini $pkgdir/usr/lib/firefox-developer-edition/distribution/.distribution.mjo
  cp palemoon/* $pkgdir/usr/lib/palemoon/distribution
  install -dm755 $pkgdir/etc/skel/.config/qupzilla/profiles
  cp -r qupzilla/* $pkgdir/etc/skel/.config/qupzilla/profiles
  [[ "$CARCH" = "i686" ]] && rm -r $pkgdir/usr/lib/firefox
  
#Hook
  install -Dm644 $srcdir/$_hook-pre.hook $pkgdir/usr/share/libalpm/hooks/$_hook-pre.hook
  install -Dm644 $srcdir/$_hook-post.hook $pkgdir/usr/share/libalpm/hooks/$_hook-post.hook
  install -Dm755 $srcdir/$_hook-pre.script $pkgdir/usr/share/libalpm/scripts/$_hook-pre
  install -Dm755 $srcdir/$_hook-post.script $pkgdir/usr/share/libalpm/scripts/$_hook-post
}
